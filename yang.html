<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameStore - แอปสโตร์เกมยอดนิยม</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Prompt', sans-serif;
            background-color: #f5f5f7;
        }
        
        .game-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .category-scroll {
            scroll-snap-type: x mandatory;
            scroll-behavior: smooth;
        }
        
        .category-item {
            scroll-snap-align: start;
        }
        
        .featured-scroll {
            scroll-snap-type: x mandatory;
            scroll-behavior: smooth;
        }
        
        .featured-item {
            scroll-snap-align: start;
        }
        
        /* Responsive fixes */
        @media (max-width: 640px) {
            .game-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* Fix for iOS momentum scrolling */
        .scrollable-area {
            -webkit-overflow-scrolling: touch;
        }
        
        /* Star rating display */
        .star-display {
            color: #fbbf24;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <a href="index.html" class="flex items-center space-x-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-indigo-600" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M13.92 3.845a19.361 19.361 0 01-6.3 1.98C6.765 5.942 5.89 6 5 6a4 4 0 00-.504 7.969 15.974 15.974 0 001.271 3.341c.397.77 1.342 1.27 2.233 1.69.26.122.52.236.78.344a4 4 0 105.832-5.708 15.973 15.973 0 00.979-2.989 4 4 0 00-1.671-6.802z" />
                    </svg>
                    <h1 class="text-2xl font-bold text-gray-800">GameStore</h1>
                </a>
                
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <input type="text" placeholder="ค้นหาเกม..." class="w-full md:w-64 pl-10 pr-4 py-2 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                    </div>
                    
                    <button id="menu-button" class="text-gray-600 hover:text-gray-900 p-2 rounded-full hover:bg-gray-100">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Side Menu -->
    <div id="side-menu" class="fixed top-0 right-[-320px] w-[320px] h-full bg-white z-50 transition-all duration-300 shadow-lg overflow-y-auto">
        <div class="p-5 border-b border-gray-100">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-indigo-600" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M13.92 3.845a19.361 19.361 0 01-6.3 1.98C6.765 5.942 5.89 6 5 6a4 4 0 00-.504 7.969 15.974 15.974 0 001.271 3.341c.397.77 1.342 1.27 2.233 1.69.26.122.52.236.78.344a4 4 0 105.832-5.708 15.973 15.973 0 00.979-2.989 4 4 0 00-1.671-6.802z" />
                    </svg>
                    <h1 class="text-2xl font-bold text-gray-800">GameStore</h1>
                </div>
                <button id="close-menu" class="text-gray-500 hover:text-gray-700 p-2 rounded-full hover:bg-gray-100">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
        </div>
        
        <div class="p-5">
            <div class="mb-6">
                <h3 class="text-xs uppercase text-gray-500 font-semibold tracking-wider mb-3">เมนูหลัก</h3>
                <ul class="space-y-1">
                    <li>
                        <a href="index.html" class="flex items-center space-x-3 p-3 rounded-lg bg-indigo-50 text-indigo-700">
                            <i class="fas fa-home w-5 text-center"></i>
                            <span>หน้าแรก</span>
                        </a>
                    </li>
                </ul>
            </div>
            
            <div class="mb-6">
                <h3 class="text-xs uppercase text-gray-500 font-semibold tracking-wider mb-3">หมวดหมู่</h3>
                <ul class="space-y-1">
                    <li>
                        <a href="#" class="flex items-center space-x-3 p-3 rounded-lg text-gray-700 hover:bg-gray-100">
                            <i class="fas fa-gamepad w-5 text-center text-indigo-600"></i>
                            <span>เกมแอคชั่น</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="flex items-center space-x-3 p-3 rounded-lg text-gray-700 hover:bg-gray-100">
                            <i class="fas fa-mountain w-5 text-center text-indigo-600"></i>
                            <span>เกมผจญภัย</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="flex items-center space-x-3 p-3 rounded-lg text-gray-700 hover:bg-gray-100">
                            <i class="fas fa-puzzle-piece w-5 text-center text-indigo-600"></i>
                            <span>เกมปริศนา</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="flex items-center space-x-3 p-3 rounded-lg text-gray-700 hover:bg-gray-100">
                            <i class="fas fa-futbol w-5 text-center text-indigo-600"></i>
                            <span>เกมกีฬา</span>
                        </a>
                    </li>
                </ul>
            </div>
            
            <div class="mb-6">
                <h3 class="text-xs uppercase text-gray-500 font-semibold tracking-wider mb-3">บริการ</h3>
                <ul class="space-y-1">
                    <li>
                        <a href="#" class="flex items-center space-x-3 p-3 rounded-lg text-gray-700 hover:bg-gray-100">
                            <i class="fas fa-download w-5 text-center text-indigo-600"></i>
                            <span>ติดตั้งแอป</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="flex items-center space-x-3 p-3 rounded-lg text-gray-700 hover:bg-gray-100">
                            <i class="fas fa-headset w-5 text-center text-indigo-600"></i>
                            <span>ช่วยเหลือ</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    
    <!-- Overlay -->
    <div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 opacity-0 invisible transition-all duration-300"></div>
    
    <!-- Main Content -->
    <main class="container mx-auto px-4 py-6">
        <!-- Featured Games Carousel -->
        <section class="mb-10">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">เกมแนะนำ</h2>
            <div class="relative">
                <div id="featured-games" class="featured-scroll flex space-x-4 overflow-x-auto pb-4 scrollable-area">
                    <!-- Featured games will be inserted here by JS -->
                </div>
            </div>
        </section>
        
        <!-- Categories -->
        <section class="mb-10">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">หมวดหมู่</h2>
            <div class="relative">
                <div class="category-scroll flex space-x-4 overflow-x-auto pb-4 scrollable-area">
                    <a href="#" class="category-item flex-shrink-0 w-32 h-24 bg-gradient-to-br from-red-400 to-red-600 rounded-lg flex flex-col items-center justify-center text-white">
                        <i class="fas fa-gamepad text-2xl mb-2"></i>
                        <span class="font-medium">แอคชั่น</span>
                    </a>
                    <a href="#" class="category-item flex-shrink-0 w-32 h-24 bg-gradient-to-br from-blue-400 to-blue-600 rounded-lg flex flex-col items-center justify-center text-white">
                        <i class="fas fa-mountain text-2xl mb-2"></i>
                        <span class="font-medium">ผจญภัย</span>
                    </a>
                    <a href="#" class="category-item flex-shrink-0 w-32 h-24 bg-gradient-to-br from-green-400 to-green-600 rounded-lg flex flex-col items-center justify-center text-white">
                        <i class="fas fa-puzzle-piece text-2xl mb-2"></i>
                        <span class="font-medium">ปริศนา</span>
                    </a>
                    <a href="#" class="category-item flex-shrink-0 w-32 h-24 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-lg flex flex-col items-center justify-center text-white">
                        <i class="fas fa-futbol text-2xl mb-2"></i>
                        <span class="font-medium">กีฬา</span>
                    </a>
                    <a href="#" class="category-item flex-shrink-0 w-32 h-24 bg-gradient-to-br from-purple-400 to-purple-600 rounded-lg flex flex-col items-center justify-center text-white">
                        <i class="fas fa-dice text-2xl mb-2"></i>
                        <span class="font-medium">เล่นเป็นกลุ่ม</span>
                    </a>
                    <a href="#" class="category-item flex-shrink-0 w-32 h-24 bg-gradient-to-br from-pink-400 to-pink-600 rounded-lg flex flex-col items-center justify-center text-white">
                        <i class="fas fa-car text-2xl mb-2"></i>
                        <span class="font-medium">แข่งรถ</span>
                    </a>
                </div>
            </div>
        </section>
        
        <!-- Popular Games -->
        <section class="mb-10">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-800">เกมยอดนิยม</h2>
                <a href="#" class="text-indigo-600 hover:text-indigo-800 text-sm font-medium">ดูทั้งหมด</a>
            </div>
            <div id="popular-games" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                <!-- Popular games will be inserted here by JS -->
            </div>
        </section>
        
        <!-- Recently Downloaded -->
        <section class="mb-10">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-800">ดาวน์โหลดล่าสุด</h2>
                <a href="#" class="text-indigo-600 hover:text-indigo-800 text-sm font-medium">ดูทั้งหมด</a>
            </div>
            <div id="recent-downloads" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                <!-- Recently downloaded games will be inserted here by JS -->
            </div>
        </section>
    </main>
    
    <!-- Footer -->
    <footer class="bg-indigo-600 text-white">
        <div class="container mx-auto px-6 py-10">
            <!-- Top Footer Section -->
            <div class="flex flex-col md:flex-row justify-between items-center mb-8">
                <div class="flex items-center space-x-3 mb-6 md:mb-0">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M13.92 3.845a19.361 19.361 0 01-6.3 1.98C6.765 5.942 5.89 6 5 6a4 4 0 00-.504 7.969 15.974 15.974 0 001.271 3.341c.397.77 1.342 1.27 2.233 1.69.26.122.52.236.78.344a4 4 0 105.832-5.708 15.973 15.973 0 00.979-2.989 4 4 0 00-1.671-6.802z" />
                    </svg>
                    <h3 class="text-2xl font-bold">GameStore</h3>
                </div>
                
                <div class="flex space-x-4">
                    <a href="#" class="bg-indigo-500 hover:bg-indigo-400 w-10 h-10 rounded-full flex items-center justify-center transition-all duration-200">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="#" class="bg-indigo-500 hover:bg-indigo-400 w-10 h-10 rounded-full flex items-center justify-center transition-all duration-200">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" class="bg-indigo-500 hover:bg-indigo-400 w-10 h-10 rounded-full flex items-center justify-center transition-all duration-200">
                        <i class="fab fa-instagram"></i>
                    </a>
                </div>
            </div>
            
            <!-- Links -->
            <div class="flex flex-col md:flex-row justify-center items-center space-y-4 md:space-y-0 md:space-x-8">
                <a href="#" class="text-indigo-200 hover:text-white transition-colors duration-200">นโยบายความเป็นส่วนตัว</a>
                <a href="#" class="text-indigo-200 hover:text-white transition-colors duration-200">เงื่อนไขการใช้งาน</a>
                <a href="#" class="text-indigo-200 hover:text-white transition-colors duration-200">คุกกี้</a>
            </div>
        </div>
    </footer>
    
    <script>
        
        // Game data structure - same as in game-details.html
        const gameData = {
            "speed-runner": {
                id: "speed-runner",
                name: "Speed Runner",
                category: "แอคชั่น",
                description: `Speed Runner เป็นเกมแอคชั่นที่ท้าทายความเร็วและความแม่นยำของคุณ! วิ่งผ่านด่านที่เต็มไปด้วยอุปสรรคและศัตรู เก็บไอเทมเพื่อเพิ่มความเร็วและพลัง

ฟีเจอร์เด่น:
• ด่านมากกว่า 100 ด่านที่ท้าทาย
• ตัวละครหลากหลายให้เลือกใช้
• ระบบอัพเกรดความสามารถ
• กราฟิกสวยงามคมชัด
• เล่นได้ทั้งออนไลน์และออฟไลน์

เหมาะสำหรับผู้เล่นทุกวัยที่ชื่นชอบเกมแนวแอคชั่นและความท้าทาย!`,
                coverColor: "from-blue-400 to-indigo-600",
                icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-24 w-24 text-white" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd" />
                </svg>`,
                screenshots: [
                    { color: "from-blue-400 to-indigo-500" },
                    { color: "from-indigo-500 to-purple-600" },
                    { color: "from-blue-500 to-cyan-400" }
                ],
                featured: true,
                popular: true
            },
            "candy-match": {
                id: "candy-match",
                name: "Candy Match",
                category: "ปริศนา",
                description: `Candy Match เป็นเกมจับคู่ลูกอมสุดสนุกที่จะทำให้คุณเพลิดเพลินไปกับการจับคู่ลูกอมหลากสีสัน ผ่านด่านต่างๆ มากมาย

ฟีเจอร์เด่น:
• ด่านมากกว่า 500 ด่าน
• ลูกอมหลากหลายรูปแบบ
• ไอเทมพิเศษมากมาย
• กราฟิกน่ารักสดใส
• อัพเดทด่านใหม่ทุกสัปดาห์

เหมาะสำหรับทุกเพศทุกวัย เล่นได้ทุกที่ทุกเวลา!`,
                coverColor: "from-pink-400 to-red-500",
                icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-24 w-24 text-white" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V9.236a1 1 0 00-1.447-.894l-4 2a1 1 0 00-.553.894V17zM15.211 6.276a1 1 0 000-1.788l-4.764-2.382a1 1 0 00-.894 0L4.789 4.488a1 1 0 000 1.788l4.764 2.382a1 1 0 00.894 0l4.764-2.382zM4.447 8.342A1 1 0 003 9.236V15a1 1 0 00.553.894l4 2A1 1 0 009 17v-5.764a1 1 0 00-.553-.894l-4-2z" />
                </svg>`,
                screenshots: [
                    { color: "from-pink-400 to-red-500" },
                    { color: "from-red-400 to-yellow-500" },
                    { color: "from-yellow-400 to-pink-500" }
                ],
                featured: true,
                popular: true
            },
            "ninja-warrior": {
                id: "ninja-warrior",
                name: "Ninja Warrior",
                category: "แอคชั่น",
                description: `Ninja Warrior เป็นเกมแอคชั่นสุดมันส์ที่คุณจะได้สวมบทบาทเป็นนินจาผู้พิทักษ์ ต่อสู้กับศัตรูมากมายด้วยอาวุธและทักษะพิเศษ

ฟีเจอร์เด่น:
• ระบบต่อสู้ที่ลื่นไหล
• อาวุธมากกว่า 30 ชนิด
• ทักษะพิเศษมากมาย
• บอสสุดแข็งแกร่ง
• กราฟิกสไตล์อนิเมะสวยงาม

เหมาะสำหรับผู้ที่ชื่นชอบเกมแอคชั่นและการต่อสู้!`,
                coverColor: "from-blue-500 to-cyan-500",
                icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-24 w-24 text-white" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd" />
                </svg>`,
                screenshots: [
                    { color: "from-blue-500 to-cyan-500" },
                    { color: "from-cyan-500 to-blue-600" },
                    { color: "from-indigo-500 to-blue-500" }
                ],
                featured: true,
                popular: true
            },
            "farm-ville": {
                id: "farm-ville",
                name: "Farm Ville",
                category: "จำลอง",
                description: "สร้างฟาร์มในฝันของคุณ ปลูกพืช เลี้ยงสัตว์ และขยายอาณาจักรการเกษตรของคุณ",
                coverColor: "from-green-400 to-emerald-600",
                icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-24 w-24 text-white" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                </svg>`,
                screenshots: [
                    { color: "from-green-400 to-emerald-500" },
                    { color: "from-emerald-500 to-green-600" },
                    { color: "from-yellow-400 to-green-500" }
                ],
                popular: true
            },
            "car-racing": {
                id: "car-racing",
                name: "Car Racing",
                category: "แข่งรถ",
                description: "สัมผัสความเร็วสุดมันส์กับเกมแข่งรถที่สมจริงที่สุด",
                coverColor: "from-red-500 to-orange-500",
                icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-24 w-24 text-white" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z" />
                    <path d="M3 4a1 1 0 00-1 1v10a1 1 0 001 1h1.05a2.5 2.5 0 014.9 0H10a1 1 0 001-1V5a1 1 0 00-1-1H3zM14 7a1 1 0 00-1 1v6.05A2.5 2.5 0 0115.95 16H17a1 1 0 001-1v-5a1 1 0 00-.293-.707l-2-2A1 1 0 0015 7h-1z" />
                </svg>`,
                screenshots: [
                    { color: "from-red-500 to-orange-500" },
                    { color: "from-orange-500 to-yellow-500" },
                    { color: "from-yellow-500 to-red-500" }
                ],
                popular: true
            },
            "space-adventure": {
                id: "space-adventure",
                name: "Space Adventure",
                category: "ผจญภัย",
                description: "ออกเดินทางสู่อวกาศอันไกลโพ้น ค้นพบดาวเคราะห์ใหม่และสิ่งมีชีวิตแปลกๆ",
                coverColor: "from-indigo-600 to-purple-600",
                icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-24 w-24 text-white" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                </svg>`,
                screenshots: [
                    { color: "from-indigo-600 to-purple-600" },
                    { color: "from-purple-600 to-indigo-600" },
                    { color: "from-blue-600 to-purple-600" }
                ]
            }
        };
        // Initialize localStorage if needed
        function initializeLocalStorage() {
            // Initialize games data
            if (!localStorage.getItem('games')) {
                const gamesData = {};
                
                // Set initial ratings and review counts
                Object.keys(gameData).forEach(gameId => {
                    gamesData[gameId] = {
                        rating: 0,
                        reviewCount: 0
                    };
                });
                
                localStorage.setItem('games', JSON.stringify(gamesData));
            }
            
            // Initialize download counts
            if (!localStorage.getItem('downloadCounts')) {
                const downloadCounts = {};
                Object.keys(gameData).forEach(gameId => {
                    downloadCounts[gameId] = 0;
                });
                localStorage.setItem('downloadCounts', JSON.stringify(downloadCounts));
            }
            
            // Initialize displayed download counts
            if (!localStorage.getItem('displayedDownloadCounts')) {
                const displayedDownloadCounts = {};
                Object.keys(gameData).forEach(gameId => {
                    displayedDownloadCounts[gameId] = 0;
                });
                localStorage.setItem('displayedDownloadCounts', JSON.stringify(displayedDownloadCounts));
            }
            
            // Initialize download history
            if (!localStorage.getItem('downloadHistory')) {
                localStorage.setItem('downloadHistory', JSON.stringify([]));
            }
        }
        
        // Create a game card element
        function createGameCard(game, gameStats) {
            const card = document.createElement('a');
            card.href = `game-details.html?id=${game.id}`;
            card.className = 'game-card bg-white rounded-xl shadow-md overflow-hidden';
            
            // Format download count
            let displayCount = gameStats?.displayedDownloadCount || 0;
            let formattedCount;
            
            if (displayCount >= 1000000) {
                formattedCount = (displayCount / 1000000).toFixed(1) + 'M+';
            } else if (displayCount >= 1000) {
                formattedCount = (displayCount / 1000).toFixed(1) + 'K+';
            } else {
                formattedCount = displayCount.toString();
            }
            
            // Format rating stars
            const rating = gameStats?.rating || 0;
            const ratingStars = '★'.repeat(Math.floor(rating)) + '☆'.repeat(5 - Math.floor(rating));
            
            card.innerHTML = `
                <div class="w-full h-32 bg-gradient-to-r ${game.coverColor} flex items-center justify-center">
                    ${game.icon}
                </div>
                <div class="p-4">
                    <h3 class="font-semibold text-gray-800 mb-1">${game.name}</h3>
                    <div class="flex items-center text-xs text-gray-500 mb-2">
                        <span class="mr-2">${game.category}</span>
                        <span>${formattedCount} ดาวน์โหลด</span>
                    </div>
                    <div class="flex items-center">
                        <div class="text-yellow-400 text-sm mr-1">${ratingStars}</div>
                        <span class="text-sm text-gray-600">${rating.toFixed(1)}</span>
                    </div>
                </div>
            `;
            
            return card;
        }
        
        // Create a featured game card
        function createFeaturedGameCard(game, gameStats) {
            const card = document.createElement('a');
            card.href = `ray.html?id=${game.id}`;
            card.className = 'featured-item flex-shrink-0 w-72 h-48 rounded-xl overflow-hidden relative shadow-lg';
            
            // Format rating stars
            const rating = gameStats?.rating || 0;
            const ratingStars = '★'.repeat(Math.floor(rating)) + '☆'.repeat(5 - Math.floor(rating));
            
            card.innerHTML = `
                <div class="w-full h-full bg-gradient-to-r ${game.coverColor} flex items-center justify-center">
                    ${game.icon}
                </div>
                <div class="absolute bottom-0 left-0 w-full bg-gradient-to-t from-black to-transparent p-4">
                    <h3 class="text-xl font-bold text-white mb-1">${game.name}</h3>
                    <div class="flex items-center">
                        <div class="text-yellow-400 text-sm mr-1">${ratingStars}</div>
                        <span class="text-sm text-white">${rating.toFixed(1)}</span>
                    </div>
                </div>
            `;
            
            return card;
        }
        
        // Load featured games
        function loadFeaturedGames() {
            const featuredGamesContainer = document.getElementById('featured-games');
            featuredGamesContainer.innerHTML = '';
            
            // Get games data from localStorage
            const gamesData = JSON.parse(localStorage.getItem('games')) || {};
            const downloadCounts = JSON.parse(localStorage.getItem('displayedDownloadCounts')) || {};
            
            // Filter featured games
            const featuredGames = Object.values(gameData).filter(game => game.featured);
            
            featuredGames.forEach(game => {
                const gameStats = {
                    rating: gamesData[game.id]?.rating || 0,
                    reviewCount: gamesData[game.id]?.reviewCount || 0,
                    displayedDownloadCount: downloadCounts[game.id] || 0
                };
                
                const card = createFeaturedGameCard(game, gameStats);
                featuredGamesContainer.appendChild(card);
            });
        }
        
        // Load popular games
        function loadPopularGames() {
            const popularGamesContainer = document.getElementById('popular-games');
            popularGamesContainer.innerHTML = '';
            
            // Get games data from localStorage
            const gamesData = JSON.parse(localStorage.getItem('games')) || {};
            const downloadCounts = JSON.parse(localStorage.getItem('displayedDownloadCounts')) || {};
            
            // Filter popular games
            const popularGames = Object.values(gameData).filter(game => game.popular);
            
            popularGames.forEach(game => {
                const gameStats = {
                    rating: gamesData[game.id]?.rating || 0,
                    reviewCount: gamesData[game.id]?.reviewCount || 0,
                    displayedDownloadCount: downloadCounts[game.id] || 0
                };
                
                const card = createGameCard(game, gameStats);
                popularGamesContainer.appendChild(card);
            });
        }
        
        // Load recently downloaded games
        function loadRecentDownloads() {
            const recentDownloadsContainer = document.getElementById('recent-downloads');
            recentDownloadsContainer.innerHTML = '';
            
            // Get download history from localStorage
            const downloadHistory = JSON.parse(localStorage.getItem('downloadHistory')) || [];
            
            // Get games data from localStorage
            const gamesData = JSON.parse(localStorage.getItem('games')) || {};
            const downloadCounts = JSON.parse(localStorage.getItem('displayedDownloadCounts')) || {};
            
            // If no downloads yet, show message
            if (downloadHistory.length === 0) {
                recentDownloadsContainer.innerHTML = `
                    <div class="col-span-full p-6 bg-gray-50 rounded-xl text-center text-gray-500">
                        คุณยังไม่มีประวัติการดาวน์โหลด
                    </div>
                `;
                return;
            }
            
            // Show most recent downloads first (up to 4)
            const recentGames = downloadHistory.slice(-4).reverse().map(gameId => gameData[gameId]);
            
            recentGames.forEach(game => {
                if (!game) return; // Skip if game not found
                
                const gameStats = {
                    rating: gamesData[game.id]?.rating || 0,
                    reviewCount: gamesData[game.id]?.reviewCount || 0,
                    displayedDownloadCount: downloadCounts[game.id] || 0
                };
                
                const card = createGameCard(game, gameStats);
                recentDownloadsContainer.appendChild(card);
            });
        }
        
        // Side menu functionality
        const sideMenu = document.getElementById('side-menu');
        const overlay = document.getElementById('overlay');
        const menuButton = document.getElementById('menu-button');
        const closeMenu = document.getElementById('close-menu');
        
        function toggleMenu() {
            if (sideMenu.style.right === '0px') {
                sideMenu.style.right = '-320px';
                overlay.classList.remove('opacity-100', 'visible');
                overlay.classList.add('opacity-0', 'invisible');
            } else {
                sideMenu.style.right = '0px';
                overlay.classList.remove('opacity-0', 'invisible');
                overlay.classList.add('opacity-100', 'visible');
            }
        }
        
        menuButton.addEventListener('click', toggleMenu);
        closeMenu.addEventListener('click', toggleMenu);
        overlay.addEventListener('click', toggleMenu);
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            initializeLocalStorage();
            loadFeaturedGames();
            loadPopularGames();
            loadRecentDownloads();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'965f3a0907b64b89',t:'MTc1MzY1MTcwOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
